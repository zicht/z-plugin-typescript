typescript:
    bin: ./node_modules/typescript/bin/tsc
    source: htmldev/src
    typings_bin: ./node_modules/typings/dist/bin.js


tasks:
    build:
        post:
            - @typescript.update

    typescript.update:
        help: Compile typescript
        args:
            _root: ? cwd
        pre: @typings.install
        do:
            - cd $(_root) && node $(typescript.bin) --project $(typescript.source)

    typescript.watch:
        help: Compile typescript and watch for changes
        args:
            _root: ? cwd
        pre: @typings.install
        do:
            - cd $(_root) && node $(typescript.bin) --project $(typescript.source) --watch

    typings.install:
        help: Download typing files
        args:
            _root: ? cwd
        unless: is_file(cat(_root, "typings.json"))
        do:
            - cd $(_root) && node $(typescript.typings_bin) install